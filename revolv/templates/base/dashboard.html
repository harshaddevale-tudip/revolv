{% extends "base/projects-list.html" %}
{% load sekizai_tags %}
{% load staticfiles %}
{% comment %}
    Dashboard

    This is the base template for the donor, ambassador, and administrator dashboards for RE-volv.
    Note that this template is the only one that does not inherit from base.html: this defines a
    totally different template inheritance tree (necessary since we don't want the footer, header,
    etc on these pages). Also, no templates directly inherit from this one: instead, this template
    includes many different partials conditionally based on the projects and the logged in user.

{% endcomment %}

{% block title %}My Portfolio - {% endblock %}
{% block head %}

    <link rel="stylesheet" type="text/css" href="{% static 'dist/css/pages/projects-list/index.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static "css/dashboard.css" %}">
    <link rel="stylesheet" type="text/css" href="{% static "css/screen.css" %}">
    <script type="text/javascript" src="{% static "js/vendor/d3.min.js" %}"></script>
    <script type="text/javascript" src="{% static "js/base/util/util.js" %}"></script>
    <script type="text/javascript" src="{% static "js/base/partialcircle.js" %}"></script>
    <script type="text/javascript" src="{% static "js/base/projects-list.js" %}"></script>
<script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>

{% endblock %}
{% block body %}
{% include "project/success_modal.html" with project=project %}
<div class='main-row dashboard'>

    <div class="container-fluid after-header">
      {% if role == 'ambassador' or role == 'admin' %}
          <div class="dashboard-sidebar col-md-2">
            {% include "base/partials/dashboard_sidebar.html" with user=user %}
          </div>
          <div class="col-md-9 col-md-offset-1">
            <div class="row">
              {% include "base/partials/impact_statistics.html" with statistics=statistics user=user donated_projecs=donated_projects %}
            </div>
          </div>
      {% else %}

        {% if donor_has_no_donated_projects %}
          <div class="no-donations">
            <div class="row">
              <div class="col-md-12">
                  <h2>Thanks for signing up with RE-volv! Looks like you haven't supported any solar projects yet.{{ request.GET.q }}</h2>
                  {% if first_project %}
                  <p><a class="btn btn-blue" href="{% url "projects_list" %}">Start contributing now!</a></p>
                  {% endif %}
              </div>
            </div>
          </div>
        {% else %}
          {% include "base/partials/impact_statistics.html" with statistics=statistics user=user donated_projecs=donated_projects %}
        {% endif %}

      {% endif %}
    </div>

</div>


    {% block body-bottom %}
    {% endblock %}
<script>
    $( document ).ready(function() {
    var str = "donation";
        if ('{{ request.GET.social }}' == 'donation')
        {
            $("#share-modal").modal("show");
        }
        else if('{{ request.GET.social }}' == 'signup')
        {
            $("#share-signup-modal").modal("show");
        }
    })
</script>

<script>
     <!--$('#share-modal #sharethis-button').remove();-->
    $('#share-signup-modal .sharethis-placeholder').append('<span id="sharethis-button"></span>');
      stWidget.addEntry({
                  <!--type:'custom',-->
                 "service":"sharethis",
                 "element":document.getElementById('sharethis-button'),
                 "url":document.URL,
                 "title":$('h1.title-h1').text(),
                 "type":"large",
                 "text":"ShareThis" ,
                 "image":$('meta[property="og:image"]').attr("content"),
                 "summary":"I just donated {0} to RE-volv in support of clean energy! Join me!"
         });
</script>

<script>
     <!--$('#share-modal #sharethis-button').remove();-->
    $('#share-modal .sharethis-placeholder').append('<span id="sharethis-button"></span>');
      stWidget.addEntry({
                  <!--type:'custom',-->
                 "service":"sharethis",
                 "element":document.getElementById('sharethis-signup-button'),
                 "url":document.URL,
                 "title":$('h1.title-h1').text(),
                 "type":"large",
                 "text":"ShareThis" ,
                 "image":$('meta[property="og:image"]').attr("content"),
                 "summary":"I just donated {0} to RE-volv in support of clean energy! Join me!"
         });
</script>
{% endblock %}
